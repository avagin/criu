FROM fedora:rawhide
ARG CC=gcc
RUN dnf install -y git gcc make protobuf-devel protobuf-c-devel libaio-devel libcap-devel libnl3-devel libnet-devel
RUN dnf install -y python

COPY . /criu
WORKDIR /criu
RUN make mrproper && make -j $(nproc) CC=$CC

# to run tests
RUN dnf install -y python-yaml python-pip

RUN pip install protobuf
RUN make -C test/zdtm/static env00
